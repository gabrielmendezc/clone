extend type Query {
  requestPasswordResetEmail(email: String!): Boolean!
  user(id: String, username: String, email: String): UserResult!
}

extend type Mutation {
  signup(data: CreateUserInput!): SignupResult!
  signupWithExternalProvider(username: String!): SignupResult!
  automateLoginProcess: AutomateLoginResult!
  login(username: String!, password: String!): LoginResult!
  resetPassword(data: ResetPasswordInput): ResetPasswordResult!
}

input ResetPasswordInput {
  currentPassword: String!
  newPassword: String!
  token: String!
}

input CreateUserInput {
  picture: String
  username: String!
  email: String!
  name: String!
  password: String!
}

type User @key(fields: "id") {
  id: ID!
  picture: String
  provider: AccountProvider!
  username: String!
  email: String!
  name: String!
  password: String!
  role: UserRole!
  lastPasswordChange: String
}

enum UserRole {
  USER
  ADMIN
}

enum AccountProvider {
  GOOGLE
  NONE
}

type TakenUsernameOrEmail {
  message: String!
}

type InvalidDataFormat {
  message: String!
}

type SuccessfulAuthentication {
  user: User!
  csrfToken: String!
}

type InvalidCredentials {
  message: String!
}

type InvalidOrMissingUserIdentifier {
  message: String!
}

type InvalidOrExpiredToken {
  message: String!
}

type PasswordsDontMatch {
  message: String!
}

type UserNotFound {
  message: String!
}

union UserResult = User | UserNotFound | InvalidDataFormat

union ResetPasswordResult = User | InvalidOrExpiredToken | PasswordsDontMatch

union AutomateLoginResult =
    SuccessfulAuthentication
  | InvalidOrMissingUserIdentifier

union SignupResult =
    SuccessfulAuthentication
  | InvalidDataFormat
  | TakenUsernameOrEmail

union LoginResult =
    SuccessfulAuthentication
  | InvalidDataFormat
  | InvalidCredentials
