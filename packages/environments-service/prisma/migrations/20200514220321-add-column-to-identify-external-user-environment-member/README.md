# Migration `20200514220321-add-column-to-identify-external-user-environment-member`

This migration has been generated by Gabriel Mendez at 5/14/2020, 10:03:21 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "Role_new" AS ENUM ('ADMIN', 'CONTRIBUTOR');
ALTER TABLE "environments"."EnvironmentMember" ALTER COLUMN "environmentRole" DROP DEFAULT,
                        ALTER COLUMN "environmentRole" TYPE "Role_new" USING ("environmentRole"::text::"Role_new"),
                        ALTER COLUMN "environmentRole" SET DEFAULT 'ADMIN';
ALTER TYPE "Role" RENAME TO "Role_old";
ALTER TYPE "Role_new" RENAME TO "Role";
DROP TYPE "Role_old"

ALTER TABLE "environments"."Environment" ADD COLUMN "ownerUserId" integer  NOT NULL ;

ALTER TABLE "environments"."EnvironmentMember" ADD COLUMN "userId" integer  NOT NULL ,
ALTER COLUMN "environmentRole" SET DEFAULT 'CONTRIBUTOR';
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200514214409-add-column-to-identify-external-user..20200514220321-add-column-to-identify-external-user-environment-member
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
@@ -18,8 +18,9 @@
   id              Int          @default(autoincrement()) @id
   environment     Environment? @relation(fields: [environmentId], references: [id])
   environmentId   Int?
   environmentRole Role         @default(CONTRIBUTOR)
+  userId          Int
 }
 enum Role {
   ADMIN
```
